<script>
const teams = [
  "Alabama","Georgia","Ohio State","Michigan","Texas","Oklahoma",
  "Clemson","Notre Dame","LSU","Florida State","Penn State","USC",
  "Tennessee","Oregon","Washington","Texas A&M","Florida","Auburn",
  "Wisconsin","Iowa","Ole Miss","Kentucky","Miami","North Carolina",
  "Utah","TCU","Baylor","Mississippi State","Arkansas","Kansas State",
  "Oklahoma State","Nebraska","South Carolina","Louisville","Missouri",
  "NC State","Virginia Tech","Maryland","UCF","Boise State"
];

// Fill dropdowns
teams.forEach(t=>{
  document.getElementById("team1").add(new Option(t,t));
  document.getElementById("team2").add(new Option(t,t));
});

let gameInterval;
let team1, team2, score1, score2, timeRemaining, quarter;

function startGame(){
  clearInterval(gameInterval);
  team1=document.getElementById("team1").value;
  team2=document.getElementById("team2").value;
  if(team1===team2) return alert("Pick different teams!");

  score1=0; score2=0; timeRemaining=900; quarter=1;
  document.getElementById("matchup").innerText=`${team1} vs ${team2}`;
  document.getElementById("plays").innerHTML="";
  updateScoreboard();

  gameInterval=setInterval(simulatePlay,2000); // new play every 2s
}

function simulatePlay(){
  if(timeRemaining<=0){
    if(quarter<4){
      quarter++;
      timeRemaining=900; // reset 15 mins
      document.getElementById("plays").innerHTML+=`<div class="quarter">-- Start of Q${quarter} --</div>`;
    } else {
      clearInterval(gameInterval);
      document.getElementById("plays").innerHTML+=`<p><b>FINAL:</b> ${team1} ${score1} - ${team2} ${score2}</p>`;
      return;
    }
  }

  timeRemaining-=Math.floor(Math.random()*40+20); // plays take 20â€“60 sec
  if(timeRemaining<0) timeRemaining=0;

  let outcome=Math.random();
  let playText="", pts=0, scoringTeam;

  if(outcome<0.55){
    playText="Drive stalls. Punt.";
  }
  else if(outcome<0.8){
    scoringTeam=Math.random()>0.5?team1:team2;
    pts=3; playText=`${scoringTeam} - FG GOOD.`;
  }
  else if(outcome<0.97){
    scoringTeam=Math.random()>0.5?team1:team2;
    pts=6; playText=`${scoringTeam} - Touchdown!`;
    if(Math.random()>0.05){ pts+=1; playText+=" XP GOOD."; } else playText+=" XP NO GOOD.";
  }
  else {
    // rarer safety (about 3% chance total)
    if(Math.random()<0.3){
      scoringTeam=Math.random()>0.5?team1:team2;
      pts=2; playText=`${scoringTeam} DEFENSE SAFETY!`;
    } else {
      playText="Drive stalls. Punt.";
    }
  }

  if(pts>0){
    if(scoringTeam===team1) score1+=pts;
    else score2+=pts;
  }

  document.getElementById("plays").innerHTML+=`<p>${formatTime()} Q${quarter} - ${playText}</p>`;
  updateScoreboard();
}

function updateScoreboard(){
  let sb=document.getElementById("scoreboard");
  sb.innerText=`${team1} ${score1} - ${team2} ${score2} | Q${quarter} ${formatTime()}`;
  updateOdds();
}

function formatTime(){
  let min=Math.floor(timeRemaining/60), sec=timeRemaining%60;
  return `${min}:${sec<10?"0":""}${sec}`;
}

function updateOdds(){
  let diff=score1-score2;
  let prob=50+diff*2-(4-quarter)*2;
  if(prob<1) prob=1; if(prob>99) prob=99;
  document.getElementById("odds").innerText=
    `Win Probability: ${team1} ${prob}% | ${team2} ${100-prob}%`;
}
</script>
