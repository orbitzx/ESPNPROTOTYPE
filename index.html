<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CFB Gamecast + Playoffs + Rank + History</title>
<link href="https://fonts.googleapis.com/css2?family=Vast+Shadow&display=swap" rel="stylesheet">
<style>
body { font-family: Arial, sans-serif; background:#121212; color:#eee; margin:0; }
header { background:#cc0000; color:white; padding:15px; text-align:center; font-size:26px; font-weight:bold; }
.container { display:flex; flex-wrap:wrap; padding:20px; gap:20px; }
.games, .gamecast, .history { flex:1; background:#1e1e1e; border-radius:8px; padding:20px; box-shadow:0 3px 8px rgba(0,0,0,0.4); }
select, button, input { padding:6px; margin:5px 0; border-radius:4px; border:none; }
button { background:#cc0000; color:white; cursor:pointer; font-weight:bold; }
button:hover { background:#e63939; }
.scoreboard { font-family:'Vast Shadow', cursive; font-size:48px; font-weight:bold; margin:10px 0; text-align:center; color:#fff; }
.quarter { margin-top:10px; font-weight:bold; color:#ffcc00; }
.plays { max-height:250px; overflow-y:auto; background:#222; border:1px solid #333; border-radius:6px; padding:8px; font-size:14px; }
.odds { margin-top:10px; text-align:center; }
.bar-container { background:#333; border-radius:5px; overflow:hidden; margin-top:8px; height:18px; width:100%; }
.bar { height:100%; transition:width 0.2s ease; }
.bar.team1 { background:#cc0000; float:left; }
.bar.team2 { background:#4444ff; float:right; }
.tab-buttons { display:flex; gap:10px; margin-bottom:10px; }
.tab-buttons button { flex:1; }
.tab-content { display:none; }
.tab-content.active { display:block; }
.speed-control { margin:10px 0; text-align:center; }
</style>
</head>
<body>

<header>College Football Gamecast</header>

<div class="tab-buttons">
  <button onclick="showTab('game')">Pick Game</button>
  <button onclick="showTab('playoff')">Playoffs</button>
  <button onclick="showTab('rank')">Rank Maker</button>
  <button onclick="showTab('history')">History</button>
</div>

<div class="container">
  <div class="games tab-content" id="game">
    <h2>Select Teams</h2>
    <select id="team1"></select>
    <select id="team2"></select>
    <button onclick="startGame()">Start Game</button>
    <button onclick="pauseGame()">Pause</button>
    <button onclick="resumeGame()">Resume</button>
    <button onclick="resetGame()">Reset</button>
    <div class="speed-control">
      Speed: <input type="range" min="0.1" max="3" step="0.1" value="1" id="speedSlider"> <span id="speedValue">1x</span>
    </div>
  </div>

  <div class="gamecast tab-content" id="gamecast">
    <h2 id="matchup">No Game Selected</h2>
    <div id="scoreboard" class="scoreboard"></div>
    <div id="odds" class="odds"></div>
    <div class="bar-container">
      <div id="barTeam1" class="bar team1" style="width:50%"></div>
      <div id="barTeam2" class="bar team2" style="width:50%"></div>
    </div>
    <div class="plays" id="plays"></div>
  </div>

  <div class="history tab-content" id="historyTab">
    <h2>Game History</h2>
    <ul id="gameHistory"></ul>
  </div>
</div>

<div class="container">
  <div class="games tab-content" id="playoff">
    <h2>CFB Playoff Builder</h2>
    <p>Select 8 Teams:</p>
    <div id="playoffTeams"></div>
    <button onclick="startPlayoffs()">Start Playoffs</button>
    <div id="playoffBracket"></div>
  </div>

  <div class="gamecast tab-content" id="rank">
    <h2>CFB Rank Maker</h2>
    <div id="rankMaker"></div>
    <button onclick="showRanks()">Show Ranks</button>
    <ul id="rankList"></ul>
  </div>
</div>

<script>
/* ---------------- TAB CONTROL ---------------- */
function showTab(id){
  document.querySelectorAll('.tab-content').forEach(tc=>tc.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
showTab('game');

/* ---------------- TEAMS ---------------- */
const teams = [
"Alabama","Georgia","Ohio State","Michigan","Texas","Oklahoma",
"Clemson","Notre Dame","LSU","Florida State","Penn State","USC",
"Tennessee","Oregon","Washington","Texas A&M","Florida","Auburn",
"Wisconsin","Iowa","Ole Miss","Kentucky","Miami","North Carolina",
"Utah","TCU","Baylor","Mississippi State","Arkansas","Kansas State",
"Oklahoma State","Nebraska","South Carolina","Louisville","Missouri",
"NC State","Virginia Tech","Maryland","UCF","Boise State","West Virginia",
"Pittsburgh","Minnesota","Michigan State","Duke","Colorado","Colorado State",
"Texas Tech","Houston","Cincinnati","BYU","Arizona","Arizona State","Stanford",
"California","Northwestern","Illinois","Purdue","Indiana","Rutgers","Syracuse",
"Wake Forest","Boston College","SMU","Tulane","Memphis"
];
teams.forEach(t=>{
  document.getElementById("team1").add(new Option(t,t));
  document.getElementById("team2").add(new Option(t,t));
});

/* ---------------- GAMECAST VARIABLES ---------------- */
let gameInterval, paused=false, history=[];
let team1, team2, score1, score2, timeRemaining, quarter, maxPlaysPerQuarter;
let speed=1;

const speedSlider=document.getElementById("speedSlider");
speedSlider.addEventListener("input", ()=>{
  speed=parseFloat(speedSlider.value);
  document.getElementById("speedValue").innerText=speed+"x";
});

/* ---------------- GAME FUNCTIONS ---------------- */
function startGame(){
  clearInterval(gameInterval);
  paused=false;
  showTab('gamecast');

  team1=document.getElementById("team1").value;
  team2=document.getElementById("team2").value;
  if(team1===team2) return alert("Pick different teams!");

  score1=0; score2=0; timeRemaining=300; quarter=1;
  maxPlaysPerQuarter = { [team1]: 3, [team2]: 3 };
  document.getElementById("matchup").innerText=`${team1} vs ${team2}`;
  document.getElementById("plays").innerHTML="";
  updateScoreboard();

  gameInterval=setInterval(simulatePlay, 400/speed);
}

function simulatePlay(){
  if(paused) return;

  if(timeRemaining<=0){
    if(quarter<4){ 
      quarter++; timeRemaining=300; maxPlaysPerQuarter = { [team1]: 3, [team2]: 3 };
      document.getElementById("plays").innerHTML+=`<div class="quarter">-- Start of Q${quarter} --</div>`;
    } else {
      clearInterval(gameInterval);
      document.getElementById("plays").innerHTML+=`<p><b>FINAL:</b> ${team1} ${score1} - ${team2} ${score2}</p>`;
      history.push({t1:team1,t2:team2,s1:score1,s2:score2});
      updateHistory();
      return;
    }
  }

  timeRemaining -= Math.floor(Math.random()*15 + 5);
  if(timeRemaining<0) timeRemaining=0;

  let playText="", pts=0, scoringTeam;

  let outcome=Math.random();
  if(outcome<0.5){ playText="Drive stalls. Punt."; }
  else if(outcome<0.7){
    scoringTeam = Math.random()>0.5 ? team1 : team2;
    if(maxPlaysPerQuarter[scoringTeam] > 0){
      pts = 3; maxPlaysPerQuarter[scoringTeam]--;
      playText=`${scoringTeam} - FG GOOD.`;
    } else playText=`${scoringTeam} attempted FG but max plays reached.`;
  }
  else if(outcome<0.9){
    scoringTeam = Math.random()>0.5 ? team1 : team2;
    if(maxPlaysPerQuarter[scoringTeam] > 0){
      pts = 6;
      if(Math.random()>0.05){ pts+=1; playText=`${scoringTeam} - Touchdown! XP GOOD.`; }
      else playText=`${scoringTeam} - Touchdown! XP NO GOOD.`;
      maxPlaysPerQuarter[scoringTeam]--;
    } else playText=`${scoringTeam} attempted TD but max plays reached.`;
  }
  else if(outcome<0.95){ playText="Interception thrown!"; }
  else if(outcome<0.98){ playText="Fumble recovered!"; }
  else { scoringTeam = Math.random()>0.5 ? team1 : team2; pts=2; playText=`${scoringTeam} DEFENSE SAFETY!`; }

  if(pts>0){
    if(scoringTeam===team1) score1+=pts;
    else score2+=pts;
  }

  document.getElementById("plays").innerHTML+=`<p>${formatTime()} Q${quarter} - ${playText}</p>`;
  updateScoreboard();
}

/* ---------------- OTHER FUNCTIONS ---------------- */
function updateScoreboard(){
  document.getElementById("scoreboard").innerText=`${team1} ${score1} - ${team2} ${score2} | Q${quarter} ${formatTime()}`;
  let diff=score1-score2, prob=50+diff*2-(4-quarter)*2;
  if(prob<1) prob=1; if(prob>99) prob=99;
  document.getElementById("odds").innerText=`Win Probability: ${team1} ${prob}% | ${team2} ${100-prob}%`;
  document.getElementById("barTeam1").style.width=prob+"%";
  document.getElementById("barTeam2").style.width=(100-prob)+"%";
}

function pauseGame(){ paused=true; }
function resumeGame(){ paused=false; }
function resetGame(){ 
  clearInterval(gameInterval); paused=false;
  document.getElementById("plays").innerHTML=""; 
  document.getElementById("matchup").innerText="No Game Selected"; 
  document.getElementById("scoreboard").innerText=""; 
  document.getElementById("odds").innerText=""; 
  document.getElementById("barTeam1").style.width="50%"; 
  document.getElementById("barTeam2").style.width="50%"; 
}

function formatTime(){ let min=Math.floor(timeRemaining/60), sec=timeRemaining%60; return `${min}:${sec<10?"0":""}${sec}`; }

function updateHistory(){
  const hist = document.getElementById("gameHistory"); hist.innerHTML="";
  history.forEach(h=>{ hist.innerHTML+=`<li>${h.t1} ${h.s1} - ${h.t2} ${h.s2}</li>`; });
}

/* AUTO-SCROLL */
const playsDiv=document.getElementById("plays"); 
const observer=new MutationObserver(()=>{ playsDiv.scrollTop=playsDiv.scrollHeight; }); 
observer.observe(playsDiv,{childList:true});

/* ---------------- PLAYOFF BUILDER ---------------- */
const playoffSlots=8; const playoffContainer=document.getElementById("playoffTeams");
for(let i=1;i<=playoffSlots;i++){ 
  let sel=document.createElement("select"); sel.id="playoff"+i; 
  teams.forEach(t=>sel.add(new Option(t,t))); 
  playoffContainer.appendChild(sel); playoffContainer.appendChild(document.createElement("br")); 
}

function startPlayoffs(){
  const selected=[]; for(let i=1;i<=playoffSlots;i++) selected.push(document.getElementById("playoff"+i).value);
  runPlayoffRound(selected,"Quarterfinals");
}

function runPlayoffRound(teamsArr, round){
  let winners=[];
  let i=0;
  function nextGame(){
    if(i>=teamsArr.length) {
      if(teamsArr.length>2) runPlayoffRound(winners, round==="Quarterfinals"?"Semifinals":"Final");
      else { document.getElementById("playoffBracket").innerHTML+=`<h4>Champion: ${winners[0]}</h4>`; return; }
      return;
    }
    const t1=teamsArr[i], t2=teamsArr[i+1]; i+=2;
    team1=t1; team2=t2; score1=0; score2=0; timeRemaining=300; quarter=1; maxPlaysPerQuarter={ [t1]:3, [t2]:3 };
    document.getElementById("matchup").innerText=`${t1} vs ${t2} (${round})`;
    document.getElementById("plays").innerHTML="";
    paused=false;
    const simInterval=setInterval(()=>{
      if(paused) return;
      if(timeRemaining<=0){
        if(quarter<4){ quarter++; timeRemaining=300; maxPlaysPerQuarter={ [t1]:3, [t2]:3 }; document.getElementById("plays").innerHTML+=`<div class="quarter">-- Start of Q${quarter} --</div>`; }
        else { clearInterval(simInterval); winners.push(score1>=score2?t1:t2); history.push({t1:t1,t2:t2,s1:score1,s2:score2}); updateHistory(); nextGame(); return; }
      }
      timeRemaining -= Math.floor(Math.random()*15 + 5);
      if(timeRemaining<0) timeRemaining=0;
      simulatePlay();
    }, 400/speed);
  }
  showTab("gamecast");
  document.getElementById("playoffBracket").innerHTML+=`<h3>${round}</h3>`;
  nextGame();
}

/* ---------------- RANK MAKER ---------------- */
const rankMakerDiv=document.getElementById("rankMaker");
teams.forEach(t=>{ 
  let input=document.createElement("input"); input.type="number"; input.value=1; input.min=1; input.max=100; input.id="rank_"+t.replace(/\s/g,"_"); 
  rankMakerDiv.appendChild(document.createTextNode(t+" ")); 
  rankMakerDiv.appendChild(input); 
  rankMakerDiv.appendChild(document.createElement("br")); 
});

function showRanks(){ 
  const ranks=[]; 
  teams.forEach(t=>{ 
    let val=parseInt(document.getElementById("rank_"+t.replace(/\s/g,"_")).value); 
    ranks.push({team:t, rank:val}); 
  }); 
  ranks.sort((a,b)=>a.rank-b.rank); 
  let listHTML=""; 
  ranks.forEach(r=>{ listHTML+=`<li>${r.rank}: ${r.team}</li>`; }); 
  document.getElementById("rankList").innerHTML=listHTML; 
}
</script>

</body>
</html>
